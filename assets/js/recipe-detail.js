async function loadRecipeDetail() {
  const params = new URLSearchParams(window.location.search);
  const slug = params.get('slug');
  const container = document.getElementById('recipeDetail');
  if (!container) return;

  try {
    const res = await fetch('data/free-recipes.json');
    const data = await res.json();
    const recipe = data.find(r => r.slug === slug);
    if (!recipe) {
      container.innerHTML = `<h2>Recipe not found</h2><p>We couldn't find the recipe you're looking for.</p>`;
      return;
    }

    // render recipe with meta and split layout
    const el = document.createElement('div');
    el.className = 'recipe-card';
    el.innerHTML = `
      <a class="back-link" href="free-recipes.html">‚Üê Back to recipes</a>
      <div class="recipe-grid">
        <div class="recipe-image"><img src="${recipe.image}" alt="${recipe.title}"></div>
        <div class="recipe-content">
          <h1 class="card-title">${recipe.title}</h1>
          <div class="recipe-meta">
            <span class="meta-chip"><span class="icon">${svgClock()}</span> Prep: <strong>${recipe.prep || '-'}</strong></span>
            <span class="meta-chip"><span class="icon">${svgFire()}</span> Cook: <strong>${recipe.cook || '-'}</strong></span>
            <span class="meta-chip"><span class="icon">${svgUser()}</span> Serves: <strong>${recipe.servings || '-'}</strong></span>
            <span class="meta-chip"><span class="icon">${svgGauge()}</span> Difficulty: <strong>${recipe.difficulty || '-'}</strong></span>
          </div>
          <p class="card-desc">${recipe.description || ''}</p>

          <h3>Ingredients</h3>
          <ul class="ingredients">
            ${ (recipe.ingredients || []).map(i => `<li>${i}</li>`).join('') }
          </ul>

          <h3>Procedure</h3>
          <ol class="procedure">
            ${ (recipe.procedure || []).map(s => `<li>${s}</li>`).join('') }
          </ol>
        </div>
      </div>
    `;

    container.appendChild(el);
  } catch (e) {
    container.innerHTML = `<h2>Error</h2><p>Unable to load recipe data.</p>`;
    console.error(e);
  }
}

document.addEventListener('DOMContentLoaded', loadRecipeDetail);

// small inline SVG helpers
function svgClock() {
  return `
    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M12 1.5a10.5 10.5 0 1 0 0 21 10.5 10.5 0 0 0 0-21zm.75 5.25v5.25l4.5 2.7-.75 1.2-5.25-3.15V6.75h1.5z"/></svg>`;
}
function svgFire() {
  return `
    <svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <path  d="M478.261,261.244c0,9.209-7.463,16.676-16.67,16.676h-5.556v11.117H55.964v-11.117h-5.556 c-9.206,0-16.67-7.466-16.67-16.676s7.463-16.676,16.67-16.676h250.359c-0.201-1.825-0.314-3.679-0.314-5.559 c0-27.628,22.39-50.026,50.009-50.026s50.009,22.397,50.009,50.026c0,1.88-0.112,3.732-0.314,5.559h61.437 C470.798,244.569,478.261,252.034,478.261,261.244z M444.922,155.635c-18.412,0-33.339,14.933-33.339,33.35 c0,18.419,14.927,33.35,33.339,33.35c18.409,0,33.339-14.931,33.339-33.35C478.261,170.567,463.331,155.635,444.922,155.635z M417.14,88.934c9.205,0,16.67-7.466,16.67-16.675c0-9.209-7.465-16.676-16.67-16.676c-9.206,0-16.67,7.466-16.67,16.676 C400.47,81.468,407.934,88.934,417.14,88.934z M461.592,33.35c9.205,0,16.67-7.466,16.67-16.676C478.261,7.466,470.796,0,461.592,0 c-9.206,0-16.67,7.466-16.67,16.676C444.922,25.884,452.387,33.35,461.592,33.35z"/>
      <path  d="M389.357,233.452c0,12.279-9.951,22.233-22.226,22.233c-12.275,0-22.226-9.954-22.226-22.233 s9.951-22.233,22.226-22.233C379.406,211.219,389.357,221.173,389.357,233.452z M450.479,166.752c-9.206,0-16.67,7.466-16.67,16.676 s7.464,16.674,16.67,16.674c9.205,0,16.67-7.466,16.67-16.674C467.149,174.218,459.684,166.752,450.479,166.752L450.479,166.752z"/>
      <path  d="M5.565,345.218v15.718c0,19.38,15.761,35.148,35.133,35.148h15.265v72.669 c0,23.787,19.455,43.246,43.233,43.246h313.608c23.779,0,43.232-19.46,43.232-43.246v-72.669H471.3 c19.374,0,35.134-15.767,35.134-35.148v-15.718c0-19.38-15.762-35.148-35.134-35.148h-15.264v-43.268H55.964v43.268H40.698 C21.326,310.071,5.565,325.838,5.565,345.218z M456.036,373.85v-41.547H471.3c7.118,0,12.909,5.793,12.909,12.914v15.718 c0,7.12-5.791,12.914-12.909,12.914h-15.264V373.85z M27.792,345.218c0-7.12,5.79-12.914,12.908-12.914h15.264v41.547H40.698 c-7.117,0-12.908-5.793-12.908-12.914v-15.72H27.792z"/>
      <path  d="M5.565,345.218v15.718c0,19.38,15.761,35.148,35.133,35.148h15.265v72.669 c0,23.787,19.455,43.246,43.233,43.246h313.608c23.779,0,43.232-19.46,43.232-43.246v-72.669H471.3 c19.374,0,35.134-15.767,35.134-35.148v-15.718c0-19.38-15.762-35.148-35.134-35.148h-15.264v-43.268H189.321V444.67 c0,12.279-9.951,22.233-22.226,22.233h-44.453c-12.276,0-22.226-9.954-22.226-22.233V266.802H55.964v43.268H40.698 C21.326,310.071,5.565,325.838,5.565,345.218z M456.036,332.305H471.3c7.118,0,12.909,5.793,12.909,12.914v15.718 c0,7.12-5.791,12.914-12.909,12.914h-15.264V332.305z M27.792,345.218c0-7.12,5.79-12.914,12.908-12.914h15.264v41.547H40.698 c-7.117,0-12.908-5.793-12.908-12.914v-15.72H27.792z"/>
      <path  d="M456.979,117.064c-1.412-5.975-7.401-9.675-13.371-8.261l-144.303,34.129l-2.971-12.57 c-4.458-18.861-23.424-30.575-42.278-26.115l-15.289,3.616c-9.109,2.155-16.846,7.748-21.787,15.752 c-4.941,8.003-6.476,17.428-4.323,26.537l2.97,12.57L71.323,196.854c-5.974,1.412-9.67,7.402-8.258,13.377 c1.209,5.114,5.77,8.562,10.805,8.562c0.846,0,1.706-0.098,2.566-0.302l372.285-88.05 C454.695,129.027,458.391,123.039,456.979,117.064z M234.287,145.038c-0.788-3.33-0.218-6.79,1.604-9.739 c1.822-2.951,4.659-5.009,7.991-5.797l15.29-3.616c6.924-1.638,13.894,2.666,15.534,9.596l2.971,12.568l-40.418,9.56 L234.287,145.038z"/>
    </svg>`;
}
function svgUser() {
  return `
    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M12 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zm0 2c-4 0-7 2-7 4v1h14v-1c0-2-3-4-7-4z"/></svg>`;
}
function svgGauge() {
  return `
    <svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <path fill="currentColor" d="m159.6,354.9c0-27.1-19.5-49.8-45.2-54.7v-278.8c0-5.8-4.7-10.4-10.4-10.4-5.8,0-10.4,4.7-10.4,10.4v278.8c-25.7,4.9-45.2,27.5-45.2,54.7 0,27.1 19.5,49.8 45.2,54.7v81c0,5.8 4.7,10.4 10.4,10.4 5.8,0 10.4-4.7 10.4-10.4v-81c25.7-4.9 45.2-27.6 45.2-54.7zm-55.7,34.8c-19.2,0-34.8-15.6-34.8-34.8 0-19.2 15.6-34.8 34.8-34.8 19.2,0 34.8,15.6 34.8,34.8 0,19.2-15.6,34.8-34.8,34.8z"/>
      <path fill="currentColor" d="m311.7,165.5c0-27.1-19.5-49.8-45.2-54.7v-89.4c0-5.8-4.7-10.4-10.4-10.4-5.8,0-10.4,4.7-10.4,10.4v89.4c-25.7,4.9-45.2,27.5-45.2,54.7 0,27.1 19.5,49.8 45.2,54.7v270.4c0,5.8 4.7,10.4 10.4,10.4 5.8,0 10.4-4.7 10.4-10.4v-270.4c25.6-4.9 45.2-27.5 45.2-54.7zm-55.7,34.9c-19.2,0-34.8-15.6-34.8-34.8 0-19.2 15.6-34.8 34.8-34.8 19.2,0 34.8,15.6 34.8,34.8 0,19.1-15.6,34.8-34.8,34.8z"/>
      <path fill="currentColor" d="m463.8,290.7c0-27.1-19.5-49.8-45.2-54.7v-214.6c0-5.8-4.7-10.4-10.4-10.4-5.8,0-10.4,4.7-10.4,10.4v214.6c-25.7,4.9-45.2,27.5-45.2,54.7s19.5,49.8 45.2,54.7v145.2c0,5.8 4.7,10.4 10.4,10.4 5.8,0 10.4-4.7 10.4-10.4v-145.2c25.7-4.9 45.2-27.6 45.2-54.7zm-55.7,34.8c-19.2,0-34.8-15.6-34.8-34.8 0-19.2 15.6-34.8 34.8-34.8 19.2,0 34.8,15.6 34.8,34.8-5.68434e-14,19.2-15.6,34.8-34.8,34.8z"/>
    </svg>`;
}
